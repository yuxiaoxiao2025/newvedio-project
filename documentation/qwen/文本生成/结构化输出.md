---
title: 结构化输出
update: 2025-11-10
source: https://help.aliyun.com/zh/model-studio/json-mode
---

执行信息抽取或结构化数据生成任务时，大模型可能返回多余文本，导致下游解析失败。开启结构化输出可确保模型输出标准 JSON 字符串。

## 使用方式

1. 设置 `response_format` 参数为 `{type: "json_object"}`
2. 在提示词中包含 “JSON” 关键词，否则会报错

## 快速开始（OpenAI 兼容）

```python
from openai import OpenAI
import os

client = OpenAI(
    api_key=os.getenv("DASHSCOPE_API_KEY"),
    base_url="https://dashscope.aliyuncs.com/compatible-mode/v1",
)

completion = client.chat.completions.create(
    model="qwen-flash",
    messages=[
        {"role": "system", "content": "请抽取用户的姓名与年龄信息，以JSON格式返回"},
        {"role": "user", "content": "大家好，我叫刘五，今年34岁，邮箱是liuwu@example.com，平时喜欢打篮球和旅游"},
    ],
    response_format={"type": "json_object"}
)

json_string = completion.choices[0].message.content
print(json_string)
```

```javascript
import OpenAI from "openai";

const openai = new OpenAI({
    apiKey: process.env.DASHSCOPE_API_KEY,
    baseURL: "https://dashscope.aliyuncs.com/compatible-mode/v1"
});

const completion = await openai.chat.completions.create({
    model: "qwen-flash",
    messages: [
        { role: "system", content: "请抽取用户的姓名与年龄信息，以JSON格式返回" },
        { role: "user", content: "大家好，我叫刘五，今年34岁，邮箱是liuwu@example.com，平时喜欢打篮球和旅游" }
    ],
    response_format: { type: "json_object" }
});

console.log(completion.choices[0].message.content);
```

## 图片、视频数据的结构化输出（多模态）

```python
from openai import OpenAI
import os

client = OpenAI(
    api_key=os.getenv("DASHSCOPE_API_KEY"),
    base_url="https://dashscope.aliyuncs.com/compatible-mode/v1",
)

completion = client.chat.completions.create(
    model="qwen-vl-max",
    messages=[
        {"role": "system", "content": [{"type": "text", "text": "You are a helpful assistant."}]},
        {"role": "user", "content": [
            {"type": "image_url", "image_url": {"url": "http://duguang-labelling.oss-cn-shanghai.aliyuncs.com/demo_ocr/receipt_zh_demo.jpg"}},
            {"type": "text", "text": "提取 ticket 和 invoice 的信息，并以 JSON 输出"}
        ]},
    ],
    response_format={"type": "json_object"}
)
print(completion.choices[0].message.content)
```

```javascript
import OpenAI from "openai";

const openai = new OpenAI({
  apiKey: process.env.DASHSCOPE_API_KEY,
  baseURL: "https://dashscope.aliyuncs.com/compatible-mode/v1"
});

const response = await openai.chat.completions.create({
  model: "qwen-vl-max",
  messages: [
    { role: "system", content: [{ type: "text", text: "You are a helpful assistant." }] },
    { role: "user", content: [
        { type: "image_url", image_url: { url: "http://duguang-labelling.oss-cn-shanghai.aliyuncs.com/demo_ocr/receipt_zh_demo.jpg" } },
        { type: "text", text: "提取 ticket 与 invoice 信息，输出 JSON" }
      ] }
  ],
  response_format: { type: "json_object" }
});
console.log(response.choices[0].message.content);
```

## 思考模型的结构化输出

思考模型会先推理再生成 JSON，输出更严谨。目前该功能仅支持 GLM 系列模型。

```python
from openai import OpenAI
import os

client = OpenAI(
    api_key=os.getenv("DASHSCOPE_API_KEY"),
    base_url="https://dashscope.aliyuncs.com/compatible-mode/v1",
)

messages=[
    {"role": "system", "content": "请抽取用户的姓名与年龄信息，以JSON格式返回"},
    {"role": "user", "content": "大家好，我叫刘五，今年34岁，邮箱是liuwu@example.com，平时喜欢打篮球和旅游"},
]

completion = client.chat.completions.create(
    model="glm-4.6",
    messages=messages,
    extra_body={"enable_thinking": True},
    stream=True,
    stream_options={"include_usage": True},
    response_format={"type": "json_object"}
)
```

```javascript
import OpenAI from "openai";

const openai = new OpenAI({
    apiKey: process.env.DASHSCOPE_API_KEY,
    baseURL: 'https://dashscope.aliyuncs.com/compatible-mode/v1'
});

const messages = [
  { role: "system", content: "请抽取用户的姓名与年龄信息，以JSON格式返回" },
  { role: "user", content: "大家好，我叫刘五，今年34岁，邮箱是liuwu@example.com，平时喜欢打篮球和旅游" },
];

const stream = await openai.chat.completions.create({
  model: 'glm-4.6',
  messages,
  stream: true,
  enable_thinking: true,
  response_format: { type: 'json_object' },
});
```
---
title: 深度思考
update: 2025-11-11
source: https://help.aliyun.com/zh/model-studio/deep-thinking
---

深度思考模型在生成回复前会先进行推理，以提升模型在逻辑推理与数值计算等复杂任务中的准确性。本文介绍如何调用支持深度思考的模型，并示例流式输出处理。

## 使用方式

- 混合思考模式：通过 `enable_thinking` 控制是否开启思考模式
- 仅思考模式：模型始终在回复前进行思考，无法关闭

## 快速开始（OpenAI 兼容）

```python
from openai import OpenAI
import os

client = OpenAI(
    api_key=os.getenv("DASHSCOPE_API_KEY"),
    base_url="https://dashscope.aliyuncs.com/compatible-mode/v1",
)

messages = [{"role": "user", "content": "你是谁"}]

completion = client.chat.completions.create(
    model="qwen-plus",
    messages=messages,
    extra_body={"enable_thinking": True},
    stream=True,
    stream_options={"include_usage": True},
)

reasoning_content = ""
answer_content = ""
is_answering = False
print("\n" + "=" * 20 + "思考过程" + "=" * 20 + "\n")

for chunk in completion:
    if not chunk.choices:
        print("\nUsage:")
        print(chunk.usage)
        continue
    delta = chunk.choices[0].delta
    if hasattr(delta, "reasoning_content") and delta.reasoning_content is not None:
        if not is_answering:
            print(delta.reasoning_content, end="", flush=True)
        reasoning_content += delta.reasoning_content
    if hasattr(delta, "content") and delta.content:
        if not is_answering:
            print("\n" + "=" * 20 + "完整回复" + "=" * 20 + "\n")
            is_answering = True
        print(delta.content, end="", flush=True)
        answer_content += delta.content
```

```javascript
import OpenAI from "openai";
import process from 'process';

const openai = new OpenAI({
    apiKey: process.env.DASHSCOPE_API_KEY,
    baseURL: 'https://dashscope.aliyuncs.com/compatible-mode/v1'
});

let reasoningContent = '';
let answerContent = '';
let isAnswering = false;

async function main() {
    const messages = [{ role: 'user', content: '你是谁' }];
    const stream = await openai.chat.completions.create({
        model: 'qwen-plus',
        messages,
        stream: true,
        enable_thinking: true
    });
    console.log('\n' + '='.repeat(20) + '思考过程' + '='.repeat(20) + '\n');
    for await (const chunk of stream) {
        if (!chunk.choices?.length) {
            console.log('\nUsage:');
            console.log(chunk.usage);
            continue;
        }
        const delta = chunk.choices[0].delta;
        if (delta.reasoning_content !== undefined && delta.reasoning_content !== null) {
            if (!isAnswering) process.stdout.write(delta.reasoning_content);
            reasoningContent += delta.reasoning_content;
        }
        if (delta.content !== undefined && delta.content) {
            if (!isAnswering) {
                console.log('\n' + '='.repeat(20) + '完整回复' + '='.repeat(20) + '\n');
                isAnswering = true;
            }
            process.stdout.write(delta.content);
            answerContent += delta.content;
        }
    }
}

main();
```

## 核心能力

- 动态切换思考/非思考模式：依据问题复杂度控制 `enable_thinking`
- 限制思考长度：通过 `thinking_budget` 控制思考 Token；当超出预算时自动终止思考并进入回复阶段
- 控制输出风格：通过 `response_format` 指定输出结构；配合结构化输出实现 JSON 返回
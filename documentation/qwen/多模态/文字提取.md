---
title: 文字提取
update: 2025-11-18
source: https://help.aliyun.com/zh/model-studio/qwen-vl-ocr
---

通义千问OCR 是专用于文字提取的视觉理解模型，可从各类图像（如扫描文档、表格、票据等）中提取文本或解析结构化数据，支持识别多种语言，并能通过特定任务指令实现信息抽取、表格解析、公式识别等高级功能。

|输入图像|识别结果|
|---|---|

|输入图像|识别结果|
|---|---|
|识别多种语言|INTERNATIONALMOTHER LANGUAGEDAYПривет!你好!Bonjour!Merhaba!Ciao!Hello!Ola!בר מולדSalam!|
|识别倾斜图像|产品介绍本品采用韩国进口纤维丝制造，不缩水、不变形、不发霉、不生菌、不伤物品表面。具有真正的不粘油、吸水力强、耐水浸、清洗干净、无毒、无残留、易晾干等特点。店家使用经验：不锈钢、陶瓷制品、浴盆、整体浴室大部分是白色的光洁表面，用其他的抹布擦洗表面污渍不易洗掉，太尖的容易划出划痕。使用这个仿真丝瓜布，沾少量中性洗涤剂揉出泡沫，很容易把这些表面污渍擦洗干净。6941990612023货号：2023|
|定位文字位置|可视化定位效果可参见常见问题将每行文本的边界框绘制到原图上。|

## 模型与价格

中国大陆（北京）国际（新加坡）|模型名称|版本|上下文长度|最大输入|最大输出|输入输出单价|免费额度（注）|
|---|---|---|---|---|---|---|
|（Token数）|（每千Token）|
|qwen-vl-ocr当前与qwen-vl-ocr-2025-04-13能力相同|稳定版|34,096|30,000单图最大30000|4,096|0.005元Batch 调用半价|各100万Token有效期：百炼开通后90天内|
|qwen-vl-ocr-latest始终与最新版能力相同|最新版|0.005元|
|qwen-vl-ocr-2025-08-28又称qwen-vl-ocr-0828文字定位能力全面升级，通用文字识别、信息抽取能力也有所提升。|快照版|
|qwen-vl-ocr-2025-04-13又称qwen-vl-ocr-0413新增六种内置OCR任务，增加自定义Prompt、图像旋转矫正等功能。|
|qwen-vl-ocr-2024-10-28又称qwen-vl-ocr-1028|

|模型名称|版本|上下文长度|最大输入|最大输出|输入输出单价|免费额度（注）|
|---|---|---|---|---|---|---|
|（Token数）|（每千Token）|
|qwen-vl-ocr|稳定版|34,096|30,000单图最大30000|4096|0.005284元|无免费额度|

```python
import math
from PIL import Image

def smart_resize(image_path, min_pixels, max_pixels):
    """
    对图像进行预处理。

    参数:
        image_path：图像的路径
    """
    image = Image.open(image_path)
    height = image.height
    width = image.width
    h_bar = round(height / 28) * 28
    w_bar = round(width / 28) * 28
    if h_bar * w_bar > max_pixels:
        beta = math.sqrt((height * width) / max_pixels)
        h_bar = math.floor(height / beta / 28) * 28
        w_bar = math.floor(width / beta / 28) * 28
    elif h_bar * w_bar < min_pixels:
        beta = math.sqrt(min_pixels / (height * width))
        h_bar = math.ceil(height * beta / 28) * 28
        w_bar = math.ceil(width * beta / 28) * 28
    return h_bar, w_bar

h_bar, w_bar = smart_resize("xxx/test.png", min_pixels=28 * 28 * 4, max_pixels=8192 * 28 * 28)
print(f"缩放后的图像尺寸为：高度为{h_bar}，宽度为{w_bar}")
token = int((h_bar * w_bar) / (28 * 28))
print(f"图像的总Token数为{token + 2}")
```

## 快速开始

```python
from openai import OpenAI
import os

PROMPT_TICKET_EXTRACTION = """
请提取车票图像中的发票号码、车次、起始站、终点站、发车日期和时间点、座位号、席别类型、票价、身份证号码、购票人姓名。
要求准确无误的提取上述关键信息、不要遗漏和捏造虚假信息，模糊或者强光遮挡的单个文字可以用英文问号?代替。
返回数据格式以json方式输出，格式为：{'发票号码'：'xxx', '车次'：'xxx', '起始站'：'xxx', '终点站'：'xxx', '发车日期和时间点'：'xxx', '座位号'：'xxx', '席别类型'：'xxx','票价':'xxx', '身份证号码'：'xxx', '购票人姓名'：'xxx'}
"""

try:
    client = OpenAI(
        api_key=os.getenv("DASHSCOPE_API_KEY"),
        base_url="https://dashscope.aliyuncs.com/compatible-mode/v1",
    )
    completion = client.chat.completions.create(
        model="qwen-vl-ocr-latest",
        messages=[
            {
                "role": "user",
                "content": [
                    {
                        "type": "image_url",
                        "image_url": "https://img.alicdn.com/imgextra/i2/O1CN01ktT8451iQutqReELT_!!6000000004408-0-tps-689-487.jpg",
                        "min_pixels": 28 * 28 * 4,
                        "max_pixels": 28 * 28 * 8192
                    },
                    {"type": "text","text": PROMPT_TICKET_EXTRACTION}
                ]
            }
        ])
    print(completion.choices[0].message.content)
except Exception as e:
    print(f"错误信息: {e}")
```

```python
import os
import dashscope

PROMPT_TICKET_EXTRACTION = """
请提取车票图像中的发票号码、车次、起始站、终点站、发车日期和时间点、座位号、席别类型、票价、身份证号码、购票人姓名。
要求准确无误的提取上述关键信息、不要遗漏和捏造虚假信息，模糊或者强光遮挡的单个文字可以用英文问号?代替。
返回数据格式以json方式输出，格式为：{'发票号码'：'xxx', '车次'：'xxx', '起始站'：'xxx', '终点站'：'xxx', '发车日期和时间点'：'xxx', '座位号'：'xxx', '席别类型'：'xxx','票价':'xxx', '身份证号码'：'xxx', '购票人姓名'：'xxx'}
"""

try:
    response = dashscope.MultiModalConversation.call(
        model='qwen-vl-ocr-latest',
        api_key=os.getenv('DASHSCOPE_API_KEY'),
        messages=[{
            'role': 'user',
            'content': [
                {'image': 'https://img.alicdn.com/imgextra/i2/O1CN01ktT8451iQutqReELT_!!6000000004408-0-tps-689-487.jpg'},
                {'text': PROMPT_TICKET_EXTRACTION}
            ]
        }]
    )
    print(response.output.choices[0].message.content[0]['text'])
except Exception as e:
    print(f"An error occurred: {e}")
```

## 调用内置任务

|task的取值|指定的Prompt|输出格式与示例|
|---|---|---|
|advanced_recognition|定位所有的文字行，并且返回旋转矩形([cx, cy, width, height, angle])的坐标结果。|格式：JSON格式的纯文本，或者从ocr_result字段中直接获取JSON对象...|

```python
import os
import dashscope

messages = [{
            "role": "user",
            "content": [{
                "image": "https://help-static-aliyun-doc.aliyuncs.com/file-manage-files/zh-CN/20241108/ctdzex/biaozhun.jpg",
                "min_pixels": 28 * 28 * 4,
                "max_pixels": 28 * 28 * 8192,
                "enable_rotate": False}] 
            }]

response = dashscope.MultiModalConversation.call(
    api_key=os.getenv('DASHSCOPE_API_KEY'),
    model='qwen-vl-ocr-2025-08-28',
    messages=messages,
    ocr_options={"task": "advanced_recognition"}
)
print(response["output"]["choices"][0]["message"].content[0]["text"]) 
```

...（完整保留Python/Node.js相关示例、表格与列表，外链已按规范标注来源）